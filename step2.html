<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Web Performance Workshop by diegocard</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <link rel="stylesheet" href="stylesheets/prism.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
    <div class="wrapper">
        <header>
            <h1><a href="index.html">Web Performance Workshop</a></h1>
            <p>by <a href="https://github.com/diegocard">Diego Cardozo</a> @ <a href="https://jsconf.uy/">JSConfUY 2016</a></p>
            <p class="view"><a href="https://github.com/diegocard/Web-Performance-Workshop">View the Project on GitHub <small>diegocard/Web-Performance-Workshop</small></a></p>
            <ul>
                <li><a href="https://github.com/diegocard/Web-Performance-Workshop/zipball/gh-pages">Download <strong>ZIP File</strong></a></li>
                <li><a href="https://github.com/diegocard/Web-Performance-Workshop/tarball/gh-pages">Download <strong>TAR Ball</strong></a></li>
                <li><a href="https://github.com/diegocard/Web-Performance-Workshop">View On <strong>GitHub</strong></a></li>
            </ul>
        </header>
        <section>
            <h2>Optimize Resources</h2>
                        
            <h3>Minify CSS and JS</h3>
            <p>One JavaScript file and one CSS file are not currently minified in this page.</p>
            
            <ol>
                <li>Find them using <a href="https://developers.google.com/speed/pagespeed/insights/">PageSpeed Insights</a></li>
                <li>Minify them using <a href="http://refresh-sf.com/">refresh-sf.com</a></li>
                <li>Alternatively, run the gulp task that compresses the JS and CSS. This also concatenates all files into a single output. Be careful, this does not remove dead code!</li>
            </ol>
<pre><code class="language-bash">
> gulp minify

[01:17:26] Using gulpfile ~\Documents\GitHub\Web-Performance-Workshop\gulpfile.js
[01:17:26] Starting 'minify-styles'...
[01:17:26] Starting 'minify-scripts'...
[01:17:26] Finished 'minify-scripts' after 272 ms
[01:17:27] Finished 'minify-styles' after 1.27 s
[01:17:27] Starting 'minify'...
[01:17:27] Finished 'minify' after 13 μs
</code></pre>
            
            <h3>Compress CSS and JS</h3>
            <ul>
                <li>Open the audit tab on Chrome's Dev Tools and run a performance audit against this page.</li>
                <li>Run the same audit against the live version of the site <a href="http://diegocard.github.io/Web-Performance-Workshop/step2.html">here</a></li>
                <li>Why is compression not present locally? Comment on <code>Content-Encoding:gzip</code></li>
                <li>You can also check for resources that are missing compression using <a href="http://gzipwtf.com/">gzipwtf.com</a></li>
            </ul>
            
            <h3>Cache CSS and JS</h3>
            <ul>
                <li>Open Chrome's dev tools, go to the Network tab and look at the response headers on the jQuery JS request</li>
                <li>Cache-Control: determines who can cache the response, under which conditions, and for how long (in seconds)</li>
                <ul>
                    <li>no-cache: always makes a round trip, but download can be prevented with etags</li>
                    <li>no-store: completely disallows cache</li>
                    <li>public: can be cached by anyone</li>
                    <li>private: can be cached by the browser, but not others (not on CDN for example)</li>
                </ul>
                <li>Etag: after the cache expires, if the fingerprint (etag) is still the same then the resource has not changed and we can skip the download</li>
                <li>More info <a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching#">here</a></li>
            </ul>
            
            <h4>Cache Control Example</h4>
            <p>
                In this example exchange the server returns a 1024 byte response, instructs the client to cache it for up to 120 seconds,
                and provides a validation token (“x234dff”).
            </p>
            <p>
                The second request is sent after the cache has expired. However, using etags we can detect that the content has not changed and
                prevent a download. 
            </p>
                
            <img src="images/step2/http-request.png" alt="HTTP request">
            
            <h3>Remove unused styles</h3>
            <ul>
                <li>Again, open the audit tab on Chrome's Dev Tools and run a performance audit against this page. Check for unused CSS</li>
                <li>You'll be able to see which rules are currently not being used by the page.</li>
                <li><a href="https://unused-css.com">unused-css.com</a> is a paid service that does this for you.</li>
                <li>Our you can use the gulp task below</li>
            </ul>
            
<pre><code class="language-bash">
> gulp unused-css

[01:43:03] Using gulpfile ~\Documents\GitHub\Web-Performance-Workshop\gulpfile.js
[01:43:03] Starting 'unused-css'...
[01:43:04] Finished 'unused-css' after 1.49 s
</code></pre> 
        </section>
    </div>
    <footer>
        <p>Project maintained by <a href="https://github.com/diegocard">diegocard</a></p>
        <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    <script src="https://code.jquery.com/jquery-1.12.3.js"></script>
    <script src="javascripts/prism.js"></script>
</body>

</html>